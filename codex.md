# ロール定義

あなたはプログラミング、特にGoに関する知識があり、複雑なTUIアプリケーションの作成経験があります。
これからTUIベースのRSSリーダーを開発します。
仕様について必要な確認をとりながら、アプリケーションを作り上げてくだくさい。
基本的な会話は日本語を使用します。

## アプリケーションの概要

このアプリケーション `quicknews` はTUIベースのRSSリーダーです。
主な目的は、ユーザーがRSSフィードを購読し、記事の内容を確認することです。
主な機能は以下のコマンドを通じて提供されます。

 • **RSSフィード管理:**
    • `add [URL...]`: 指定されたURLのRSSフィードをデータベースに追加します。既に存在するフィードはスキップされます。
    • `import [OPMLファイルパス]`: OPMLファイルからフィードを一括でインポートします。既に存在するフィードはスキップされます。
    • `fetch [-i INTERVAL]`: 登録されているフィードを更新し、新しい記事を取得します。
        • 新しい記事はデータベースに保存されます。
        • 記事の要約が存在しない場合、Google Gemini APIを使用して要約を生成し、保存します（失敗時はリトライあり）。
        • 設定に応じて、要約から音声データを生成し、ファイルパスを保存します。
        • 設定に応じて、要約をOrg mode形式でエクスポートします。
        • `-i` オプションで指定した間隔（例: `24h`）で定期的に実行できます。デフォルトは1回実行です。
        • 多数の記事を処理する場合、プログレスバーが表示されます。
 • **記事の閲覧とインタラクション:**
    • `read [--no-fetch] [-s RATE] [--voicevox] [--speaker ID]`: TUIを起動し、フィードや記事を閲覧します。
        • TUI内から記事の要約表示、音声再生などが可能です。
        • `--no-fetch` オプションで、TUI起動中のバックグラウンドでの記事取得を無効化できます。
        • `-s` オプションで音声読み上げ速度を指定できます。
        • `--voicevox` と `--speaker` オプションでVoiceVoxエンジンとスピーカーを指定できます。
    • `play [--no-fetch] [--date YYYY-MM-DD]`: まだ聞いていない（未聴の）記事の要約を順番に再生します。
        • 再生が完了した要約は既聴としてマークされます。
        • `--date` オプションで特定の日付の記事のみを再生対象にできます。
        • `--no-fetch` オプションで、再生中のバックグラウンドでの記事取得を無効化できます。
    • `bookmark [URL...]`: 指定されたURLをブックマークとして保存します。
        • ブックマークは特別なフィードとして扱われ、記事の取得や要約生成が行われます。
 • **エクスポートと公開:**
    • `export_audio`: 既存の全ての要約に対して音声データを再生成し、ファイルパスをデータベースに保存します。
    • `publish [YYYY-MM-DD]`: 指定された日付（デフォルトは当日）を含む過去数日分の記事の音声ファイルをフィードごとに結合し、Cloudflare R2にアップロードしてPodcastフィードとして公開します。
        • 設定ファイル (`config.toml`) で `AudioPath` と `Podcast` の設定が必要です。
        • PodcastフィードのRSSファイルも生成され、R2にアップロードされます。
    • （設定による自動エクスポート）: `fetch` コマンド実行時、環境変数 `EXPORT_ORG` が設定されていれば、生成された要約がOrg mode形式のファイルとして指定ディレクトリにエクスポートされます。

## 技術スタック

開発言語はGoです。
データベースにはsqlite3を使用します。
データベースアクセスを行うライブラリにはent(https://entgo.io/)を使用します。
TUIライブラリにはbubblesを使用します。
LLMにはGoogle Geminiを使用します。
